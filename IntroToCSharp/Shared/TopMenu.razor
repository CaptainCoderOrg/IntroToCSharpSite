<MudAppBar Elevation="25">
    <MudIconButton Icon="@Icons.Material.Outlined.Menu" Color="Color.Inherit" OnClick="@Main.ToggleNavMenu" Edge="Edge.Start"/>
    <MudToggleIconButton @bind-Toggled="@Main.IsDarkMode"
                         ToggledIcon="@Icons.Material.Outlined.LightMode"
                         Icon="@Icons.Material.Outlined.DarkMode"
                         Color="Color.Inherit" />
    <MudSpacer />
    @if (UserData.IsLoggedIn)
    {
        <MudElement>@UserData.DisplayName </MudElement>
        <MudMenu>
            <ActivatorContent>
                <MudAvatar Class="ml-4" Color="Color.Secondary">@UserData.AvatarLetter</MudAvatar>
            </ActivatorContent>
            <ChildContent>
                <MudMenuItem OnClick="@UserService.Service.Logout">Logout</MudMenuItem>
            </ChildContent>
        </MudMenu>
    }
    else
    {
        <MudButton href="javascript:void(0);" OnClick="@UserService.Service.Login" Variant="Variant.Filled" Color="Color.Tertiary" class="ml-md-auto">Login</MudButton>
    }
</MudAppBar>

@code
{
    [Parameter, EditorRequired]
    public MainLayout Main {get; set;} = null!;
    public User UserData = User.NoUser;

    private void UpdateUser(User user)
    {
        UserData = user;
        InvokeAsync(StateHasChanged);
    }

    protected override void OnInitialized()
    {

        UserService.Service.OnUserChange += UpdateUser;
    }
}